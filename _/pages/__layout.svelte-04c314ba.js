import{S as e,i as a,s as t,D as o,l as n,k as l,e as s,j as i,t as r,E as c,d,n as f,c as u,a as w,m as h,g as m,b as p,F as g,G as v,f as y,o as I,H as $,I as b,x as k,u as S,v as E,J as x,A as R}from"../chunks/vendor-452fb534.js";import{c as T}from"../chunks/utils-798ae020.js";import{b as A}from"../chunks/paths-45dac81d.js";let j;function N(e){window.postMessage({msg:"installedStatusChange",isInstalled:e})}function O(){function e(){return"complete"===document.readyState&&(window.setTimeout((()=>location.reload()),250),!0)}e()||document.addEventListener("readystatechange",(()=>{e()}))}const P={async clearCacheAndReload(){var e,a,t,o;try{await(null==(o=null==(t=await(null==(a=null==(e=navigator.serviceWorker)?void 0:e.getRegistration)?void 0:a.call(e)))?void 0:t.unregister)?void 0:o.call(t))}catch{}await fetch(`/clear-site-data/?random=${Math.floor(1e10*Math.random())}`);for await(let n of await window.caches.keys())await window.caches.delete(n);localStorage.setItem("afterReload","reloadAgain"),O()},async installAppOrDownload(){(null==j?void 0:j.prompt)?j.prompt():(window.localStorage.setItem("afterReload","downloadFiles"),window.setTimeout((()=>location.reload())))},async preparePwa(){switch(localStorage.getItem("afterReload")){case"downloadFiles":localStorage.removeItem("afterReload"),await async function(){const e=await(async()=>{let e=await(await window.fetch("./_/filestocache.json")).json();return e=e.map((e=>new URL(e,`${location.origin}${A}/`).href)),e})(),a=await(async()=>{let e=[];for await(const a of await window.caches.keys())e=[...e,...(await(await window.caches.open(a)).keys()).map((({url:e})=>e))];return e})(),t=e.filter((e=>!a.includes(e))).map((e=>window.fetch(e)));await Promise.all(t)}();break;case"reloadAgain":JSON.parse(localStorage.getItem("isInstalled"))?localStorage.setItem("afterReload","downloadFiles"):localStorage.setItem("afterReload","reloadThirdTime"),O();break;case"reloadThirdTime":localStorage.removeItem("afterReload"),O()}window.addEventListener("beforeinstallprompt",(async e=>{e.preventDefault(),N(!1),localStorage.removeItem("isInstalled"),j=e})),window.addEventListener("appinstalled",(async e=>{N(!0),window.localStorage.setItem("afterReload","downloadFiles"),localStorage.setItem("isInstalled",JSON.stringify(!0)),window.setTimeout((()=>location.reload()))}))}};class F extends e{constructor(e){super(),a(this,e,null,null,t,{})}}function L(e){let a,t,R,A,j,N,O,L,M,B,_,D,U,C,J,V,G,H,W,q,z,K,Q,X;N=new F({});const Y=e[2].default,Z=o(Y,e,e[1],null);return{c(){a=n(),t=l(),R=s("input"),A=l(),j=s("div"),i(N.$$.fragment),O=l(),L=s("nav"),M=s("button"),B=l(),_=s("button"),D=l(),U=s("label"),C=l(),J=s("main"),Z&&Z.c(),V=l(),G=s("footer"),H=r("Made with "),W=s("span"),q=r("❤"),z=r(" by Benjamin Aster"),this.h()},l(e){const o=c('[data-svelte="svelte-8pnnl9"]',document.head);a=n(),o.forEach(d),t=f(e),R=u(e,"INPUT",{type:!0,id:!0}),A=f(e),j=u(e,"DIV",{id:!0,class:!0});var l=w(j);h(N.$$.fragment,l),O=f(l),L=u(l,"NAV",{class:!0});var s=w(L);M=u(s,"BUTTON",{title:!0,class:!0}),w(M).forEach(d),B=f(s),_=u(s,"BUTTON",{title:!0,class:!0}),w(_).forEach(d),D=f(s),U=u(s,"LABEL",{for:!0,title:!0,class:!0,id:!0,tabindex:!0}),w(U).forEach(d),s.forEach(d),C=f(l),J=u(l,"MAIN",{class:!0});var i=w(J);Z&&Z.l(i),i.forEach(d),V=f(l),G=u(l,"FOOTER",{class:!0});var r=w(G);H=m(r,"Made with "),W=u(r,"SPAN",{style:!0});var p=w(W);q=m(p,"❤"),p.forEach(d),z=m(r," by Benjamin Aster"),r.forEach(d),l.forEach(d),this.h()},h(){p(R,"type","checkbox"),p(R,"id","theme-toggler"),R.hidden=!0,p(M,"title","pop out window"),p(M,"class","bi-box-arrow-up-right svelte-14g53aa"),p(_,"title","clear cache & reload"),p(_,"class","bi-arrow-clockwise svelte-14g53aa"),p(U,"for","theme-toggler"),p(U,"title","toggle light/dark theme"),p(U,"class","bi-moon-fill svelte-14g53aa"),p(U,"id","theme-toggler-label"),p(U,"tabindex","0"),p(L,"class","svelte-14g53aa"),p(J,"class","svelte-14g53aa"),g(W,"color","red"),p(G,"class","svelte-14g53aa"),p(j,"id","actual-content"),p(j,"class","svelte-14g53aa")},m(o,n){v(document.head,a),y(o,t,n),y(o,R,n),y(o,A,n),y(o,j,n),I(N,j,null),v(j,O),v(j,L),v(L,M),v(L,B),v(L,_),v(L,D),v(L,U),v(j,C),v(j,J),Z&&Z.m(J,null),v(j,V),v(j,G),v(G,H),v(G,W),v(W,q),v(G,z),K=!0,Q||(X=[$(M,"click",e[3]),$(_,"click",P.clearCacheAndReload),$(U,"click",T.store)],Q=!0)},p(e,[a]){Z&&Z.p&&(!K||2&a)&&b(Z,Y,e,e[1],K?a:-1,null,null)},i(e){K||(k(false),k(N.$$.fragment,e),k(Z,e),K=!0)},o(e){S(false),S(N.$$.fragment,e),S(Z,e),K=!1},d(e){d(a),e&&d(t),e&&d(R),e&&d(A),e&&d(j),E(N),Z&&Z.d(e),Q=!1,x(X)}}}var M=function(e,a,t,o){return new(t||(t=Promise))((function(n,l){function s(e){try{r(o.next(e))}catch(a){l(a)}}function i(e){try{r(o.throw(e))}catch(a){l(a)}}function r(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(s,i)}r((o=o.apply(e,a||[])).next())}))};function B({page:e,fetch:a,session:t,context:o}){return M(this,void 0,void 0,(function*(){return{props:{renderInfo:yield(yield a("./_/info.json")).json()}}}))}function _(e,a,t){let{$$slots:o={},$$scope:n}=a;var l=this&&this.__awaiter||function(e,a,t,o){return new(t||(t=Promise))((function(n,l){function s(e){try{r(o.next(e))}catch(a){l(a)}}function i(e){try{r(o.throw(e))}catch(a){l(a)}}function r(e){var a;e.done?n(e.value):(a=e.value,a instanceof t?a:new t((function(e){e(a)}))).then(s,i)}r((o=o.apply(e,a||[])).next())}))};let{renderInfo:s}=a;R((()=>l(void 0,void 0,void 0,(function*(){yield async function(){await P.preparePwa(),T.setInitial()}()}))));return e.$$set=e=>{"renderInfo"in e&&t(0,s=e.renderInfo),"$$scope"in e&&t(1,n=e.$$scope)},[s,n,o,async()=>{window.open(location.href,"_blank","location=yes")}]}export default class extends e{constructor(e){super(),a(this,e,_,L,t,{renderInfo:0})}}export{B as load};
